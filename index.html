<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Â¡Atrapa la Gaseosa Arcade! v5.0</title>
<style>
  body {
    text-align: center;
    font-family: sans-serif;
    background: #222;
    color: #fff;
    margin: 0;
    padding: 0;
    overflow: hidden;
  }
  h1 { color: #ffdd00; margin: 10px 0; }
  #puntaje { font-size: 20px; margin: 10px; }
  #mensaje { font-size: 20px; margin: 10px; }
  .moneda, .diamante {
    position: absolute;
    font-size: 50px;
    transition: transform 0.2s ease;
  }
  #menu {
    position: fixed;
    top: 10px;
    right: 10px;
    background: rgba(0,0,0,0.7);
    padding: 10px;
    border-radius: 10px;
  }
  #menu button {
    margin: 5px;
    padding: 5px 10px;
    font-size: 14px;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>Â¡Atrapa la Gaseosa Arcade! ðŸ¥¤ v5.0</h1>
<p id="puntaje">Pesos: 0 | Vidas: 5</p>
<p id="mensaje">Presiona L, C o R para atrapar la moneda</p>

<div id="menu" style="display:none;">
  <button onclick="triggerParty()">PARTY</button>
  <button onclick="clearMonedas()">CLEAR</button>
  <button onclick="triggerDiamonds()">RAIN DIAMONDS</button>
</div>

<!-- Scripts -->
<script>
// ===== Variables Principales =====
let pesos = 0;
let vidas = 5;
const opciones = ['L','C','R'];
const puntajeEl = document.getElementById('puntaje');
const mensajeEl = document.getElementById('mensaje');
const menuEl = document.getElementById('menu');

let secuenciaManual = []; // para control manual
let indiceSecuencia = 0;
let monedasActivas = [];

// ===== Sonidos =====
const sonidoMoneda = new Audio('https://freesound.org/data/previews/341/341695_3248244-lq.mp3');
const sonidoDiamante = new Audio('https://freesound.org/data/previews/274/274178_5121236-lq.mp3');

// ===== Funciones de Monedas =====
function crearMoneda(pos, tipo="moneda") {
  const m = document.createElement('div');
  m.className = tipo;
  m.innerText = tipo === "moneda" ? "ðŸ’°" : "ðŸ’Ž";
  document.body.appendChild(m);
  const posicionesX = {L: window.innerWidth*0.2, C: window.innerWidth*0.5, R: window.innerWidth*0.8};
  m.style.left = posicionesX[pos] + "px";
  m.style.top = "50px";
  monedasActivas.push(m);

  // Animacion simple
  setInterval(()=>{ m.style.transform = `rotate(${Math.random()*360}deg)`; }, 200);
  return pos;
}

function nuevaMoneda() {
  let pos = secuenciaManual.length > 0 ? secuenciaManual[indiceSecuencia] : opciones[Math.floor(Math.random()*3)];
  if(secuenciaManual.length>0){
    indiceSecuencia = (indiceSecuencia+1) % secuenciaManual.length;
  }
  return crearMoneda(pos);
}

// ===== Comando Admin CODMAS =====
document.addEventListener('keydown', function(e){
  const key = e.key.toUpperCase();
  
  if(key === "CODMAS"){ 
    menuEl.style.display = menuEl.style.display === "none" ? "block" : "none";
    return;
  }

  if(!opciones.includes(key)) return;

  // Revisar moneda actual
  const monedaActual = monedasActivas[0] ? monedasActivas[0].innerText : null;
  if((key === 'L' && monedaActual.includes('L')) || 
     (key === 'C' && monedaActual.includes('C')) || 
     (key === 'R' && monedaActual.includes('R')) ) {
    pesos++;
    mensajeEl.innerText = `Â¡Atrapaste la moneda en ${key}!`;
    if(monedasActivas[0]) { monedasActivas[0].remove(); monedasActivas.shift(); }
    sonidoMoneda.play();
  } else {
    vidas--;
    mensajeEl.innerText = `Fallaste, intenta de nuevo.`;
  }
  puntajeEl.innerText = `Pesos: ${pesos} | Vidas: ${vidas}`;

  if(pesos >= 7){
    alert('Â¡Felicidades! Ganaste tu gaseosa ðŸ¥¤');
    resetJuego();
  } else if(vidas <= 0){
    alert('Perdiste todas tus vidas ðŸ˜¢');
    resetJuego();
  }

  if(monedasActivas.length === 0) nuevaMoneda();
});

// ===== Funciones Eventos =====
function triggerParty(){
  for(let i=0;i<10;i++){
    const pos = opciones[Math.floor(Math.random()*3)];
    crearMoneda(pos);
  }
}

function clearMonedas(){
  monedasActivas.forEach(m=>m.remove());
  monedasActivas = [];
}

function triggerDiamonds(){
  for(let i=0;i<5;i++){
    const pos = opciones[Math.floor(Math.random()*3)];
    crearMoneda(pos,"diamante");
    sonidoDiamante.play();
  }
}

// ===== Reset =====
function resetJuego(){
  pesos = 0;
  vidas = 5;
  puntajeEl.innerText = `Pesos: ${pesos} | Vidas: ${vidas}`;
  mensajeEl.innerText = 'Presiona L, C o R para atrapar la moneda';
  clearMonedas();
  nuevaMoneda();
}

// ===== Inicio =====
nuevaMoneda();

</script>
</body>
</html>
